

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Periodic pattern mining, an example with Canadian TV programs &mdash; scikit-mine 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Compatibility with Scikit-Learn" href="../../sklearn_compat.html" />
    <link rel="prev" title="&lt;no title&gt;" href="index.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/skmine_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation from pypi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#installation-from-sources">Installation from sources</a></li>
</ul>
<p><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/feature_extraction.html">Feature Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/itemsets.html">Itemsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/periodic.html">Periodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/emerging.html">Emerging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/base.html">Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/callbacks.html">Callback API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/graph.html">Graphs</a></li>
</ul>
<p><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../datasets/fetch_fimi_datasets.html">Fetch FIMI datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/generate_synthetic_transactional_data.html">Generate synthetic transactional data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../itemsets/linear_time_closed_item_set_miner.html">Linear time Closed item set Miner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../itemsets/SLIM_for_market_basket_analysis.html">SLIM for market basket analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../itemsets/classification_examples_with_SLIM.html">Classification examples with SLIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../callbacks/callback_API_demo.html">Callback API demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph/GraphMDL_for_graph_pattern_mining.html">GraphMDL for graph pattern mining</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Periodic pattern mining, an example with Canadian TV programs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#The-problem,-informally">The problem, informally</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Introduction-to-periodic-pattern-mining">Introduction to periodic pattern mining</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#The-cycle-:-a-building-block-for-periodic-pattern-mining">The cycle : a building block for periodic pattern mining</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Handling-noise-in-our-timestamps">Handling noise in our timestamps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#A-tiny-example-with-scikit-mine">A tiny example with scikit-mine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#An-example-with-Canadian-TV-programs">An example with Canadian TV programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Fetching-logs-from-canadian-TV">Fetching logs from canadian TV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Searching-for-cycles-in-TV-programs">Searching for cycles in TV programs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Viewing-the-patterns">Viewing the patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Patterns-import---export">Patterns import - export</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Did-I-find-cycles-for-the-TV-show-“Arthurt-Shorts”">Did I find cycles for the TV show “Arthurt Shorts”</a></li>
<li class="toctree-l3"><a class="reference internal" href="#What-are-the-top-10-longest-cycles-?">What are the top 10 longest cycles ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-are-the-10-most-unpunctual-TV-programs-?">what are the 10 most unpunctual TV programs ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#What-TV-programs-have-been-broadcasted-every-day-for-at-least-5-days-straight?">What TV programs have been broadcasted every day for at least 5 days straight?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#What-TV-programs-are-broadcast-only-on-business-days-?">What TV programs are broadcast only on business days ?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Load-your-own-custom-datasets">Load your own custom datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-**Each-line-consists-of-a-datetime-followed-by-its-associated-event.">1. **Each line consists of a datetime followed by its associated event.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Datetimes-can-also-be-replaced-by-integers.">2. <strong>Datetimes can also be replaced by integers</strong>.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Use-only-the-name-of-the-events.">3. <strong>Use only the name of the events</strong>.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#References">References</a></li>
</ul>
<p><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sklearn_compat.html">Compatibility with Scikit-Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html#inclusion-criteria">Inclusion criteria</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html#development-process">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HISTORY.html">History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">scikit-mine</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Periodic pattern mining, an example with Canadian TV programs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/periodic/periodic_pattern_mining_on_canadian_TV_logs.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Periodic-pattern-mining,-an-example-with-Canadian-TV-programs">
<h1>Periodic pattern mining, an example with Canadian TV programs<a class="headerlink" href="#Periodic-pattern-mining,-an-example-with-Canadian-TV-programs" title="Permalink to this headline">¶</a></h1>
<p><img alt="logo" src="../../_images/skmine_series.png" /></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">skmine</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This tutorial was tested with the following version of skmine :&quot;</span><span class="p">,</span> <span class="n">skmine</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Be sure to execute this notebook in the dir `docs/tutorials/periodic`,</span>
<span class="s2">to be able to load the data files `.csv`.</span>
<span class="s2">If not, please do so and adapt the bash commands below</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="o">%</span><span class="k">pwd</span>
<span class="c1"># %cd docs/tutorials/periodic</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
This tutorial was tested with the following version of skmine : 0.0.11

Be sure to execute this notebook in the dir `docs/tutorials/periodic`,
to be able to load the data files `.csv`.
If not, please do so and adapt the bash commands below

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;/home/hcourtei/Projects/F-WIN/scikit-mine/codes/skMineDev/docs/tutorials/periodic&#39;
</pre></div></div>
</div>
<section id="The-problem,-informally">
<h2>The problem, informally<a class="headerlink" href="#The-problem,-informally" title="Permalink to this headline">¶</a></h2>
<p>Let’s take a simple example.</p>
<p>Imagine you set an alarm to wake up every day around 7:30AM, and go to work. Sometimes you wake up a bit earlier (your body anticipates the alarm), and sometimes a bit later, for example if you press the “snooze” button and refuse to face the fact that you have to wake up.</p>
<p>In python we can load those “wake up” events as logs, and store them in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">pandas.Series</a>, like</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">one_day</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span>  <span class="c1"># a day in minutes</span>
<span class="n">minutes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">one_day</span> <span class="o">*</span> <span class="mi">7</span><span class="p">]</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s2">&quot;wake up&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">minutes</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s2">&quot;16/04/2020 07:30&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M&quot;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">start</span> <span class="o">+</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">e</span><span class="p">))</span>
<span class="n">S</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>  <span class="c1"># minutes as the lowest unit of difference</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2020-04-16 07:30:00    wake up
2020-04-17 07:29:00    wake up
2020-04-18 07:29:00    wake up
2020-04-19 07:30:00    wake up
2020-04-20 07:32:00    wake up
2020-04-23 07:30:00    wake up
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;2020-04-16T07:30:00.000000000&#39;, &#39;2020-04-17T07:29:00.000000000&#39;,
       &#39;2020-04-18T07:29:00.000000000&#39;, &#39;2020-04-19T07:30:00.000000000&#39;,
       &#39;2020-04-20T07:32:00.000000000&#39;, &#39;2020-04-23T07:30:00.000000000&#39;],
      dtype=&#39;datetime64[ns]&#39;)
</pre></div></div>
</div>
<p>We can see the wake-up time is not exactly the same every day, but overall a consistent regular pattern seems to emerge.</p>
<p>Now imagine that in addition to wake up times, we also have records of other daily activities (meals, work, household chores, etc.), and that rather than a handful of days, those records span several years and make up several thousands of events</p>
<p><strong>Can you automatically identify regularities to better understand your daily routine?</strong></p>
</section>
<section id="Introduction-to-periodic-pattern-mining">
<h2>Introduction to periodic pattern mining<a class="headerlink" href="#Introduction-to-periodic-pattern-mining" title="Permalink to this headline">¶</a></h2>
<p>Periodic pattern mining aims at exploiting regularities not only about <em>what happens</em> by finding coordinated event occurrences, but also about <em>when it happens</em> and <em>how it happens</em>. It’s about not just finding things that happen repeatedly, but that happen regularly, with a consistent periodicity.</p>
<p>Next, we introduce the concept of cycles</p>
<section id="The-cycle-:-a-building-block-for-periodic-pattern-mining">
<h3>The cycle : a building block for periodic pattern mining<a class="headerlink" href="#The-cycle-:-a-building-block-for-periodic-pattern-mining" title="Permalink to this headline">¶</a></h3>
<p>Here is an explicit example of a cycle</p>
<p><img alt="cycle" src="../../_images/cycle_color.png" /></p>
<p>This definition, while being relatively simple, is general enough to allow us to find regularities in different types of logs</p>
</section>
<section id="Handling-noise-in-our-timestamps">
<h3>Handling noise in our timestamps<a class="headerlink" href="#Handling-noise-in-our-timestamps" title="Permalink to this headline">¶</a></h3>
<p>Needless to say, it would be too easy if events in our data were equally spaced. As data often comes noisy, we have to be fault tolerant, and allow small errors to sneak into our cycles.</p>
<p>That’s the role of **shift corrections*, which capture the small deviations from perfectly regular periodic repetitions, and allow to reconstruct the (noisy) original sequence of events, using the following relation <img alt="shifts" src="../../_images/shifts.png" /></p>
</section>
<section id="A-tiny-example-with-scikit-mine">
<h3>A tiny example with scikit-mine<a class="headerlink" href="#A-tiny-example-with-scikit-mine" title="Permalink to this headline">¶</a></h3>
<p><strong>scikit-mine</strong> offers a <code class="docutils literal notranslate"><span class="pre">PeriodicPatternMiner</span></code>, out of the box. You can use it to detect regularities, in the form of <em>(possibly nested) cycles</em>, which we call <em>periodic patterns</em>.</p>
<p>These patterns are evaluated using a MDL criterion, to help us extract a compact and representative collection of patterns from the data, trying to avoid redundancy between patterns, in particular.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">skmine.periodic</span> <span class="kn">import</span> <span class="n">PeriodicPatternMiner</span>
<span class="n">pcm</span> <span class="o">=</span> <span class="n">PeriodicPatternMiner</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">pcm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-04-16 07:30:00</td>
      <td>(wake up)[r=5 p=1 day, 0:00:00]</td>
      <td>5</td>
      <td>1 days</td>
      <td>0 days 00:04:00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>You can see one cycle has been extracted for our event <strong>wake up</strong>. The cycle covers the entire business week, but not the last monday separated by the weekend</p>
<p>It has a length of 5 and a period close to 1 day, as expected.</p>
<p>Also, note that we mix some information here. Our period of 1 day offers the best summary for this data. Accessing the little “shifts” as encountered in original data is also possible, with an extra argument in our call : <code class="docutils literal notranslate"><span class="pre">pcm.transform(S,dE_sum=False)</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">res_wake</span> <span class="o">=</span> <span class="n">pcm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">dE_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">res_wake</span><span class="o">.</span><span class="n">E</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    [-1 days +23:59:00, 0 days 00:00:00, 0 days 00:01:00, 0 days 00:02:00]
Name: E, dtype: object
</pre></div></div>
</div>
<p>The last column named <code class="docutils literal notranslate"><span class="pre">E</span></code> contains a list of shifts to apply to our cycle in case we want to reconstruct the original data. Trailing zeros have been removed for efficiency, and their values are <em>relative to the period</em>, but we can see there is: * -1 minute shift (-1 days +23:59:00), between the 1st and 2nd entry (waking up at 7:30 on 04-16 at 7:29 on 04-17) * no shift between the 2nd and 3rd entry (still waking up at 7:29 on 04-18) * + 1 minute shift between the 3rd and 4th entry (back to
7:30 on 04-19) * + 2 minutes shift between the 4th and 5th entry (waking up at 7:32 on 04-20)</p>
<p>Events that are not captured by any pattern are called <code class="docutils literal notranslate"><span class="pre">redisuals</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">get_residuals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-04-23 07:30:00</td>
      <td>wake up</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>This way <code class="docutils literal notranslate"><span class="pre">pcm</span></code> does not store all the data, but has all information needed to reconstruct it entirely !!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-04-16 07:30:00</td>
      <td>wake up</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-04-17 07:29:00</td>
      <td>wake up</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-04-18 07:29:00</td>
      <td>wake up</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-04-19 07:30:00</td>
      <td>wake up</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-04-20 07:32:00</td>
      <td>wake up</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="An-example-with-Canadian-TV-programs">
<h2>An example with Canadian TV programs<a class="headerlink" href="#An-example-with-Canadian-TV-programs" title="Permalink to this headline">¶</a></h2>
<section id="Fetching-logs-from-canadian-TV">
<h3>Fetching logs from canadian TV<a class="headerlink" href="#Fetching-logs-from-canadian-TV" title="Permalink to this headline">¶</a></h3>
<p>In this section we are going to load some event logs of TV programs (the <em>WHAT</em>), indexed by their broadcast timestamps (the <em>WHEN</em>).</p>
<p><code class="docutils literal notranslate"><span class="pre">PeriodicPatternMiner</span></code> is here to help us discovering regularities (the <em>HOW</em>)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">skmine.datasets</span> <span class="kn">import</span> <span class="n">fetch_canadian_tv</span>
<span class="kn">from</span> <span class="nn">skmine.periodic</span> <span class="kn">import</span> <span class="n">PeriodicPatternMiner</span>
</pre></div>
</div>
</div>
</section>
<section id="Searching-for-cycles-in-TV-programs">
<h3>Searching for cycles in TV programs<a class="headerlink" href="#Searching-for-cycles-in-TV-programs" title="Permalink to this headline">¶</a></h3>
<p>Remember about the definition of cycles ? Let’s apply it to our TV programs</p>
<p>In our case</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the name of a TV program</p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> is the number of broadcasts (repetitions) for this TV program (inside this cycle)</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the optimal time delta between broadcasts in this cycle. If a program is meant to be live everyday at 14:00PM, then <span class="math notranslate nohighlight">\(p\)</span> is likely to be <em>1 day</em></p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\)</span> is the first broadcast time in this cycle</p></li>
<li><p><span class="math notranslate nohighlight">\(dE\)</span> are the shift corrections between the <span class="math notranslate nohighlight">\(p\)</span> and the actual broadcast time of an event. If a TV program was scheduled at 8:30:00AM and it went on air at 8:30:23AM the same day, then we keep track of a <em>23 seconds shift</em>. This way we can summarize our data (via cycles), and reconstruct it (via shift corrections).</p></li>
</ul>
<p>Finally we are going to dig a little deeper into these cycles, to answer quite complex questions about our logs. We will see that cycles contains usefull information about our input data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ctv_logs</span> <span class="o">=</span> <span class="n">fetch_canadian_tv</span><span class="p">()</span>
<span class="n">ctv_logs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
timestamp
2020-08-01 06:00:00            The Moblees
2020-08-01 06:11:00    Big Block Sing Song
2020-08-01 06:13:00    Big Block Sing Song
2020-08-01 06:15:00               CBC Kids
2020-08-01 06:15:00               CBC Kids
Name: canadian_tv, dtype: string
</pre></div></div>
</div>
<p>Compute only simple cycles on ctv_logs with the karg <em>complex=False</em> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span> <span class="o">=</span> <span class="n">PeriodicPatternMiner</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ctv_logs</span><span class="p">)</span>
<span class="n">pcm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ctv_logs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/hcourtei/Projects/F-WIN/scikit-mine/codes/skMineDev/skmine/periodic/cycles.py:131: UserWarning: found 234 duplicates in the input sequence, they have been removed.
  warnings.warn(f&#34;found {diff} duplicates in the input sequence, they have been removed.&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>2020-08-01 04:00:00</td>
      <td>(Rick Mercer Report)[r=5 p=7 days, 0:00:00]</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2020-08-01 04:30:00</td>
      <td>(Rick Mercer Report)[r=5 p=7 days, 0:00:00]</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2020-08-01 05:00:00</td>
      <td>(Grand Designs)[r=31 p=1 day, 0:00:00]</td>
      <td>31</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>59</th>
      <td>2020-08-01 06:00:00</td>
      <td>(The Moblees)[r=5 p=7 days, 0:00:00]</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2020-08-01 06:11:00</td>
      <td>(Big Block Sing Song)[r=5 p=7 days, 0:00:00]</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>254</th>
      <td>2020-08-26 14:00:00</td>
      <td>(Jamie's Super Foods)[r=3 p=1 day, 0:00:00]</td>
      <td>3</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>183</th>
      <td>2020-08-27 02:00:00</td>
      <td>(Mr. D)[r=4 p=0:30:00]</td>
      <td>4</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-28 00:00:00</td>
      <td>(Schitt's Creek)[r=8 p=0:30:00]</td>
      <td>8</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>129</th>
      <td>2020-08-29 06:15:00</td>
      <td>(CBC Kids)[r=23 p=0:12:00]</td>
      <td>23</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:26:00</td>
    </tr>
    <tr>
      <th>126</th>
      <td>2020-08-30 06:11:00</td>
      <td>(CBC Kids)[r=11 p=0:12:00]</td>
      <td>11</td>
      <td>0 days 00:12:00</td>
      <td>0 days 00:49:00</td>
    </tr>
  </tbody>
</table>
<p>278 rows × 5 columns</p>
</div></div>
</div>
<p>Compute simple and complex (with horizontal and vertical combinations) cycles on ctv_logs :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span> <span class="o">=</span> <span class="n">PeriodicPatternMiner</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ctv_logs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/hcourtei/Projects/F-WIN/scikit-mine/codes/skMineDev/skmine/periodic/cycles.py:131: UserWarning: found 234 duplicates in the input sequence, they have been removed.
  warnings.warn(f&#34;found {diff} duplicates in the input sequence, they have been removed.&#34;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">cycles</span> <span class="o">=</span> <span class="n">pcm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ctv_logs</span><span class="p">)</span>
<span class="n">cycles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>34</th>
      <td>2020-08-01 04:00:00</td>
      <td>(Rick Mercer Report [d=0:30:00] Rick Mercer Report)[r=5 p=7 days, 0:00:00]</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2020-08-01 05:00:00</td>
      <td>(Grand Designs)[r=31 p=1 day, 0:00:00]</td>
      <td>31</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-08-01 06:00:00</td>
      <td>(The Moblees [d=0:11:00] Big Block Sing Song [d=0:02:00] Big Block Sing Song [d=0:02:00] CBC Kid...</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:03:00</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2020-08-01 06:15:00</td>
      <td>(CBC Kids [d=1:40:00] Big Block Sing Song [d=0:02:00] Furchester Hotel [d=0:38:00] Ollie: The Bo...</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:02:00</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2020-08-01 06:15:00</td>
      <td>(CBC Kids)[r=29 p=0:12:00]</td>
      <td>29</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:54:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109</th>
      <td>2020-08-26 14:00:00</td>
      <td>(Jamie's Super Foods)[r=3 p=1 day, 0:00:00]</td>
      <td>3</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>86</th>
      <td>2020-08-27 02:00:00</td>
      <td>(Mr. D)[r=4 p=0:30:00]</td>
      <td>4</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2020-08-28 00:00:00</td>
      <td>(Schitt's Creek)[r=8 p=0:30:00]</td>
      <td>8</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>100</th>
      <td>2020-08-29 06:15:00</td>
      <td>(CBC Kids)[r=23 p=0:12:00]</td>
      <td>23</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:26:00</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2020-08-31 07:00:00</td>
      <td>(CBC Kids)[r=17 p=0:13:00]</td>
      <td>17</td>
      <td>0 days 00:13:00</td>
      <td>0 days 02:15:00</td>
    </tr>
  </tbody>
</table>
<p>121 rows × 5 columns</p>
</div></div>
</div>
<p><strong>Note</strong> : no need to worry for the warning, it’s here to notify duplicate event/timestamp pairs have been found</p>
</section>
<section id="Viewing-the-patterns">
<h3>Viewing the patterns<a class="headerlink" href="#Viewing-the-patterns" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the patterns are complicated to understand textually. The <code class="docutils literal notranslate"><span class="pre">draw_pattern</span></code> function allows you to visualise them. Simply indicate in pattern the id of the pattern you wish to view from the results of the previous transform.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">draw_pattern</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="c1"># if you want to save the tree, you can add a `directory` parameter to indicate the location of the results (pdf + generated DOT file)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_periodic_periodic_pattern_mining_on_canadian_TV_logs_27_0.svg" src="../../_images/tutorials_periodic_periodic_pattern_mining_on_canadian_TV_logs_27_0.svg" /></div>
</div>
</section>
<section id="Patterns-import---export">
<h3>Patterns import - export<a class="headerlink" href="#Patterns-import---export" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Store in a json file the patterns (&quot;patterns.json&quot; by default)</span>
<span class="n">pcm</span><span class="o">.</span><span class="n">export_patterns</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;patterns.json&quot;</span><span class="p">)</span>

<span class="c1"># reinitialize the PeriodicPatternMiner :</span>
<span class="n">pcm</span> <span class="o">=</span> <span class="n">PeriodicPatternMiner</span><span class="p">()</span>

<span class="c1"># import the json file (&quot;patterns.json&quot; by default)</span>
<span class="n">pcm</span><span class="o">.</span><span class="n">import_patterns</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;patterns.json&quot;</span><span class="p">)</span>

<span class="c1"># recompute the pattern :</span>
<span class="n">cycles</span> <span class="o">=</span> <span class="n">pcm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ctv_logs</span><span class="p">)</span>
<span class="n">cycles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-08-01 04:00:00</td>
      <td>(Rick Mercer Report [d=0:30:00] Rick Mercer Report)[r=5 p=7 days, 0:00:00]</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-01 05:00:00</td>
      <td>(Grand Designs)[r=31 p=1 day, 0:00:00]</td>
      <td>31</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-01 06:00:00</td>
      <td>(The Moblees [d=0:11:00] Big Block Sing Song [d=0:02:00] Big Block Sing Song [d=0:02:00] CBC Kid...</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:03:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-01 06:15:00</td>
      <td>(CBC Kids [d=1:40:00] Big Block Sing Song [d=0:02:00] Furchester Hotel [d=0:38:00] Ollie: The Bo...</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:02:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-08-01 06:15:00</td>
      <td>(CBC Kids)[r=29 p=0:12:00]</td>
      <td>29</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:54:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>116</th>
      <td>2020-08-26 14:00:00</td>
      <td>(Jamie's Super Foods)[r=3 p=1 day, 0:00:00]</td>
      <td>3</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>117</th>
      <td>2020-08-27 02:00:00</td>
      <td>(Mr. D)[r=4 p=0:30:00]</td>
      <td>4</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>118</th>
      <td>2020-08-28 00:00:00</td>
      <td>(Schitt's Creek)[r=8 p=0:30:00]</td>
      <td>8</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>119</th>
      <td>2020-08-29 06:15:00</td>
      <td>(CBC Kids)[r=23 p=0:12:00]</td>
      <td>23</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:26:00</td>
    </tr>
    <tr>
      <th>120</th>
      <td>2020-08-31 07:00:00</td>
      <td>(CBC Kids)[r=17 p=0:13:00]</td>
      <td>17</td>
      <td>0 days 00:13:00</td>
      <td>0 days 02:15:00</td>
    </tr>
  </tbody>
</table>
<p>121 rows × 5 columns</p>
</div></div>
</div>
<p>Now that we have our cycles in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">pandas.DataFrame</a>, we can play with the pandas API and answer questions about our logs</p>
</section>
<section id="Did-I-find-cycles-for-the-TV-show-“Arthurt-Shorts”">
<h3>Did I find cycles for the TV show “Arthurt Shorts”<a class="headerlink" href="#Did-I-find-cycles-for-the-TV-show-“Arthurt-Shorts”" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-08-01 04:00:00</td>
      <td>(Rick Mercer Report [d=0:30:00] Rick Mercer Report)[r=5 p=7 days, 0:00:00]</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-01 05:00:00</td>
      <td>(Grand Designs)[r=31 p=1 day, 0:00:00]</td>
      <td>31</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-01 06:00:00</td>
      <td>(The Moblees [d=0:11:00] Big Block Sing Song [d=0:02:00] Big Block Sing Song [d=0:02:00] CBC Kid...</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:03:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-01 06:15:00</td>
      <td>(CBC Kids [d=1:40:00] Big Block Sing Song [d=0:02:00] Furchester Hotel [d=0:38:00] Ollie: The Bo...</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:02:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-08-01 06:15:00</td>
      <td>(CBC Kids)[r=29 p=0:12:00]</td>
      <td>29</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:54:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>116</th>
      <td>2020-08-26 14:00:00</td>
      <td>(Jamie's Super Foods)[r=3 p=1 day, 0:00:00]</td>
      <td>3</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>117</th>
      <td>2020-08-27 02:00:00</td>
      <td>(Mr. D)[r=4 p=0:30:00]</td>
      <td>4</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>118</th>
      <td>2020-08-28 00:00:00</td>
      <td>(Schitt's Creek)[r=8 p=0:30:00]</td>
      <td>8</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>119</th>
      <td>2020-08-29 06:15:00</td>
      <td>(CBC Kids)[r=23 p=0:12:00]</td>
      <td>23</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:26:00</td>
    </tr>
    <tr>
      <th>120</th>
      <td>2020-08-31 07:00:00</td>
      <td>(CBC Kids)[r=17 p=0:13:00]</td>
      <td>17</td>
      <td>0 days 00:13:00</td>
      <td>0 days 02:15:00</td>
    </tr>
  </tbody>
</table>
<p>121 rows × 5 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycles</span><span class="p">[</span><span class="n">cycles</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;Arthur Shorts&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>2020-08-01 10:48:00</td>
      <td>(Addison [d=0:12:00] Arthur Shorts [d=0:13:00] Stella &amp; Sam [d=0:12:00] Wandering Wenda [d=0:34:...</td>
      <td>5</td>
      <td>7 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2020-08-03 09:35:00</td>
      <td>((Arthur Shorts [d=0:13:00] Arthur Shorts)[r=5 p=1 day, 0:00:00] [d=0:45:00] (Furchester Hotel [...</td>
      <td>3</td>
      <td>6 days 23:59:00</td>
      <td>0 days 00:22:00</td>
    </tr>
    <tr>
      <th>112</th>
      <td>2020-08-24 09:35:00</td>
      <td>(Arthur Shorts [d=0:13:00] Arthur Shorts [d=0:15:00] Kiri &amp; Lou [d=0:17:00] Furchester Hotel [d=...</td>
      <td>5</td>
      <td>0 days 23:59:00</td>
      <td>0 days 00:11:00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="What-are-the-top-10-longest-cycles-?">
<h3>What are the top 10 longest cycles ?<a class="headerlink" href="#What-are-the-top-10-longest-cycles-?" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycles</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;repetition_major&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2020-08-01 05:00:00</td>
      <td>(Grand Designs)[r=31 p=1 day, 0:00:00]</td>
      <td>31</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020-08-01 06:57:00</td>
      <td>(CBC Kids)[r=31 p=1 day, 0:00:00]</td>
      <td>31</td>
      <td>1 days 00:00:00</td>
      <td>0 days 00:33:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-08-01 06:15:00</td>
      <td>(CBC Kids)[r=29 p=0:12:00]</td>
      <td>29</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:54:00</td>
    </tr>
    <tr>
      <th>105</th>
      <td>2020-08-22 06:15:00</td>
      <td>(CBC Kids)[r=27 p=0:12:00]</td>
      <td>27</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:14:00</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2020-08-15 06:15:00</td>
      <td>(CBC Kids)[r=25 p=0:12:00]</td>
      <td>25</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:00:00</td>
    </tr>
    <tr>
      <th>73</th>
      <td>2020-08-08 06:15:00</td>
      <td>(CBC Kids)[r=23 p=0:11:00]</td>
      <td>23</td>
      <td>0 days 00:11:00</td>
      <td>0 days 02:42:00</td>
    </tr>
    <tr>
      <th>119</th>
      <td>2020-08-29 06:15:00</td>
      <td>(CBC Kids)[r=23 p=0:12:00]</td>
      <td>23</td>
      <td>0 days 00:12:00</td>
      <td>0 days 02:26:00</td>
    </tr>
    <tr>
      <th>120</th>
      <td>2020-08-31 07:00:00</td>
      <td>(CBC Kids)[r=17 p=0:13:00]</td>
      <td>17</td>
      <td>0 days 00:13:00</td>
      <td>0 days 02:15:00</td>
    </tr>
    <tr>
      <th>106</th>
      <td>2020-08-23 06:11:00</td>
      <td>(CBC Kids)[r=12 p=0:13:00]</td>
      <td>12</td>
      <td>0 days 00:13:00</td>
      <td>0 days 00:38:00</td>
    </tr>
    <tr>
      <th>68</th>
      <td>2020-08-07 00:13:00</td>
      <td>(Schitt's Creek)[r=8 p=0:30:00]</td>
      <td>8</td>
      <td>0 days 00:30:00</td>
      <td>0 days 00:13:00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-08-01 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-02 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-03 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-04 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-08-05 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-08-06 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020-08-07 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-08-08 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020-08-09 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020-08-10 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020-08-11 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020-08-12 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020-08-13 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020-08-14 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020-08-15 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2020-08-16 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2020-08-17 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2020-08-18 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2020-08-19 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2020-08-20 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2020-08-21 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2020-08-22 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2020-08-23 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2020-08-24 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2020-08-25 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2020-08-26 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2020-08-27 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2020-08-28 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2020-08-29 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2020-08-30 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2020-08-31 05:00:00</td>
      <td>Grand Designs</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pcm</span><span class="o">.</span><span class="n">get_residuals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>143</th>
      <td>2020-08-01 01:12:00</td>
      <td>OLYMPIC GAMES REPLAY</td>
    </tr>
    <tr>
      <th>287</th>
      <td>2020-08-01 13:00:00</td>
      <td>Bondi Vet</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2020-08-01 13:30:00</td>
      <td>Basketball</td>
    </tr>
    <tr>
      <th>122</th>
      <td>2020-08-01 15:55:00</td>
      <td>Basketball</td>
    </tr>
    <tr>
      <th>347</th>
      <td>2020-08-01 19:00:00</td>
      <td>Still Standing</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>351</th>
      <td>2020-08-31 16:00:00</td>
      <td>Escape to the Country</td>
    </tr>
    <tr>
      <th>348</th>
      <td>2020-08-31 17:00:00</td>
      <td>Murdoch Mysteries</td>
    </tr>
    <tr>
      <th>409</th>
      <td>2020-08-31 17:59:00</td>
      <td>News</td>
    </tr>
    <tr>
      <th>386</th>
      <td>2020-08-31 19:00:00</td>
      <td>Hockey Night in Canada</td>
    </tr>
    <tr>
      <th>74</th>
      <td>2020-08-31 23:15:00</td>
      <td>CBC News: The National</td>
    </tr>
  </tbody>
</table>
<p>454 rows × 2 columns</p>
</div></div>
</div>
</section>
<section id="what-are-the-10-most-unpunctual-TV-programs-?">
<h3>what are the 10 most unpunctual TV programs ?<a class="headerlink" href="#what-are-the-10-most-unpunctual-TV-programs-?" title="Permalink to this headline">¶</a></h3>
<p>For this we are going to : 1. extract the shift corrections along with other informations about our cycles 2. compute the sum of the absolute values for the shift corrections, for every cycles 3. get the 10 biggest sums</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># full_cycles = pcm.transform(x)</span>
<span class="c1"># full_cycles.head()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># def absolute_sum(*args):</span>
<span class="c1">#     return sum(map(abs, *args))</span>

<span class="c1"># # level 0 is the name of the TV program</span>
<span class="c1"># shift_sums = full_cycles[&quot;dE&quot;].map(absolute_sum).groupby(level=[0]).sum()</span>
<span class="c1"># shift_sums.nlargest(10)</span>
</pre></div>
</div>
</div>
<!-- #### what are the 10 most unpunctual TV programs ?
For this we are going to :
 1. extract the shift corrections along with other informations about our cycles
 2. compute the sum of the absolute values for the shift corrections, for every cycles
 3. get the 10 biggest sums --><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># def absolute_sum(*args):</span>
<span class="c1">#     return sum(map(abs, *args))</span>

<span class="c1"># # level 0 is the name of the TV program</span>
<span class="c1"># shift_sums = full_cycles[&quot;dE&quot;].map(absolute_sum).groupby(level=[0]).sum()</span>
<span class="c1"># shift_sums.nlargest(10)</span>
</pre></div>
</div>
</div>
</section>
<section id="What-TV-programs-have-been-broadcasted-every-day-for-at-least-5-days-straight?">
<h3>What TV programs have been broadcasted every day for at least 5 days straight?<a class="headerlink" href="#What-TV-programs-have-been-broadcasted-every-day-for-at-least-5-days-straight?" title="Permalink to this headline">¶</a></h3>
<p>Let’s make use of the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html">pandas.DataFrame.query</a> method to express our question in an SQL-like syntax</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># cycles.query(&#39;length_major &gt;= 5 and period_major &gt;= 3600&#39;, engine=&#39;python&#39;)</span>
<span class="c1"># # cycles.query(&#39;length &gt;= 5 and period == &quot;1 days&quot;&#39;, engine=&#39;python&#39;)</span>
</pre></div>
</div>
</div>
</section>
<section id="What-TV-programs-are-broadcast-only-on-business-days-?">
<h3>What TV programs are broadcast only on business days ?<a class="headerlink" href="#What-TV-programs-are-broadcast-only-on-business-days-?" title="Permalink to this headline">¶</a></h3>
<p>From the previous query we see we have a lot of 5-length cycles, with periods of 1 day. An intuition is that these cycles take place on business days. Let’s confirm this by considering cycles with 1. start timestamps on mondays 2. periods of roughly 1 day</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># monday_starts = cycles[cycles.start.dt.weekday == 0]  # start on monday</span>
<span class="c1"># monday_starts.query(&#39;length == 5 and period == &quot;1 days&quot;&#39;, engine=&#39;python&#39;)</span>
</pre></div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="Load-your-own-custom-datasets">
<h2>Load your own custom datasets<a class="headerlink" href="#Load-your-own-custom-datasets" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">If you want to <strong>use your own datasets from file</strong>, you can use the <code class="docutils literal notranslate"><span class="pre">fetch_file</span></code> function.</div>
<div class="line">There are <strong>3 ways to write</strong> :</div>
</div>
<section id="1.-**Each-line-consists-of-a-datetime-followed-by-its-associated-event.">
<h3>1. **Each line consists of a datetime followed by its associated event.<a class="headerlink" href="#1.-**Each-line-consists-of-a-datetime-followed-by-its-associated-event." title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">** By default, <strong>the separator is a ``,``</strong>. This is customisable.</div>
<div class="line">Example :</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;dataset_datetime.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;2020-04-16 07:30:00,wake up&#39;,
 &#39;2020-04-17 07:29:00,wake up&#39;,
 &#39;2020-04-17 07:29:00,wake up&#39;,
 &#39;2020-04-18 07:29:00,wake up&#39;,
 &#39;2020-04-19 07:30:00,wake up&#39;,
 &#39;2020-04-20 07:32:00,wake up&#39;,
 &#39;2020-04-23 07:30:00,wake up&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">skmine.datasets.periodic</span> <span class="kn">import</span> <span class="n">fetch_file</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">fetch_file</span><span class="p">(</span><span class="s2">&quot;dataset_datetime.csv&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>  <span class="c1"># by default separator is already comma</span>
<span class="n">pcm</span> <span class="o">=</span> <span class="n">PeriodicPatternMiner</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">pcm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/hcourtei/Projects/F-WIN/scikit-mine/codes/skMineDev/skmine/periodic/cycles.py:131: UserWarning: found 1 duplicates in the input sequence, they have been removed.
  warnings.warn(f&#34;found {diff} duplicates in the input sequence, they have been removed.&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t0</th>
      <th>pattern</th>
      <th>repetition_major</th>
      <th>period_major</th>
      <th>sum_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-04-16 07:30:00</td>
      <td>(wake up)[r=5 p=1 day, 0:00:00]</td>
      <td>5</td>
      <td>1 days</td>
      <td>0 days 00:04:00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Note that several formats for datetimes can be infered from example. But you can force to parse string according to a specific format with the extra option : <code class="docutils literal notranslate"><span class="pre">format=&quot;%d/%m/%Y</span> <span class="pre">%H:%M:%S&quot;</span></code> . see <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior</a> for all possibilities - <code class="docutils literal notranslate"><span class="pre">2020-04-23</span> <span class="pre">07:30:00</span></code> -&gt; YYYY-MM-DD hh:mm:ss - <code class="docutils literal notranslate"><span class="pre">1997-07-23T19:20+01:00</span></code> -&gt; YYYY-MM-DDThh:mmTZD (TZD = time zone designator) - <code class="docutils literal notranslate"><span class="pre">1997-07-23T19:20:30.45+01:00</span></code> -&gt; YYYY-MM-DDThh:mm:ss.sTZD -
<code class="docutils literal notranslate"><span class="pre">02/23/2018</span></code> -&gt; MM/DD/YYYY - <code class="docutils literal notranslate"><span class="pre">02/23/18</span></code> -&gt; MM/DD/YY - …</p>
<p><strong>2 points of caution</strong> are to be noted: - <strong>Beware of this type of format “Feb 23, 2018” (Mth d, YYYY)</strong> because comma is the default separator. If you want to use this format, you must use <strong>double quotes around the date</strong>. - <strong>The MM/DD (Month/day) format is infered by default (when day is less than 12)</strong>, for DD/MM; use format option as in example below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fetch_file</span><span class="p">(</span><span class="s2">&quot;dataset_datetime_DD_MM.csv&quot;</span><span class="p">,</span>  <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;,&#39;</span> <span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M:%S&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
timestamp
2018-02-10 07:30:00    wake up
2018-02-23 07:30:00     coffee
2018-03-10 07:30:00    wake up
Name: dataset_datetime_DD_MM.csv, dtype: string
</pre></div></div>
</div>
</section>
<section id="2.-Datetimes-can-also-be-replaced-by-integers.">
<h3>2. <strong>Datetimes can also be replaced by integers</strong>.<a class="headerlink" href="#2.-Datetimes-can-also-be-replaced-by-integers." title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span><span class="p">:</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;dataset_integer.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;1,wake up&#39;,
 &#39;3,wake up&#39;,
 &#39;10,wake up&#39;,
 &#39;30,wake up&#39;,
 &#39;40,wake up&#39;,
 &#39;70,wake up&#39;,
 &#39;100,wake up&#39;]
</pre></div></div>
</div>
</section>
<section id="3.-Use-only-the-name-of-the-events.">
<h3>3. <strong>Use only the name of the events</strong>.<a class="headerlink" href="#3.-Use-only-the-name-of-the-events." title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">In this case, <strong>the indexes correspond to the line numbers (starting from 0)</strong>.</div>
<div class="line">Example:</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;dataset_no_index.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;wake up&#39;, &#39;wake up&#39;, &#39;wake up&#39;, &#39;wake up&#39;, &#39;wake up&#39;, &#39;wake up&#39;, &#39;wake up&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">fetch_file</span><span class="p">(</span><span class="s2">&quot;dataset_no_index.csv&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
timestamp
0    wake up
1    wake up
2    wake up
3    wake up
4    wake up
5    wake up
6    wake up
Name: dataset_no_index.csv, dtype: string
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="References">
<h1>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p>Galbrun, E &amp; Cellier, P &amp; Tatti, N &amp; Termier, A &amp; Crémilleux, B “Mining Periodic Pattern with a MDL Criterion”</p></li>
<li><p>Galbrun, E “The Minimum Description Length Principle for Pattern Mining : A survey”</p></li>
<li><p>Termier, A <a class="reference external" href="http://people.irisa.fr/Alexandre.Termier/dmv/DMV_Periodic_patterns.pdf">“Periodic pattern mining”</a></p></li>
</ol>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../sklearn_compat.html" class="btn btn-neutral float-right" title="Compatibility with Scikit-Learn" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, scikit-mine team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>